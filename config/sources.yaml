# Source configuration for Iran Crisis Simulation ingestion
#
# Buckets (coverage window):
#   osint_thinktank (36h): ISW, CTP
#   ngo_rights (72h): HRANA, IHR, Amnesty, HRW
#   regime_outlets (72h): IRNA, Tasnim, Mehr, Fars
#   persian_services (72h): Iran International, Radio Farda, BBC Persian
#   internet_monitoring (72h): NetBlocks
#   econ_fx (72h): Rial/inflation proxies
#
# Access grades: A (high quality) to D (low quality)
# Bias grades: 1 (neutral) to 5 (highly biased)

sources:
  # =========================================================================
  # OSINT THINK TANKS (36h window)
  # =========================================================================
  - id: isw
    name: "Institute for the Study of War"
    type: web
    bucket: osint_thinktank
    urls:
      - https://understandingwar.org/
    access_grade: B
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_isw
    enabled: true
    notes: "RSS blocked with 403, using web scraper for homepage Iran Update links"

  - id: ctp
    name: "Critical Threats Project"
    type: web
    bucket: osint_thinktank
    urls:
      - https://www.criticalthreats.org/analysis
    selectors:
      article: "article"
      title: "h3 a"
      date: "time"
      content: ".article-meta"
    filters:
      - keyword: "iran"
    access_grade: B
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_web
    enabled: true
    notes: "RSS removed (404), using web scraper for analysis page filtered by 'iran'"

  # =========================================================================
  # NGO / RIGHTS MONITORS (72h window)
  # =========================================================================
  - id: hrana
    name: "Human Rights Activists News Agency"
    type: web
    bucket: ngo_rights
    urls:
      - https://www.en-hrana.org/category/news/
    selectors:
      article: "article"
      title: "h3 a"
      date: "time"
      content: "p"
    access_grade: B
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_playwright
    enabled: true
    notes: "Cloudflare JS challenge - uses Playwright. May fail intermittently when Cloudflare escalates to interactive CAPTCHA."

  - id: ihr
    name: "Iran Human Rights"
    type: web
    bucket: ngo_rights
    urls:
      - https://iranhr.net/en/
    selectors:
      article: "article"
      title: "h3 a"
      date: "time"
      content: "p"
    access_grade: B
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_playwright
    enabled: true
    notes: "Cloudflare JS challenge - uses Playwright. May fail intermittently when Cloudflare escalates to interactive CAPTCHA."

  - id: amnesty
    name: "Amnesty International"
    type: rss
    bucket: ngo_rights
    urls:
      - https://www.amnesty.org/en/latest/news/feed/
    filters:
      - keyword: "iran"
    access_grade: A
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true

  - id: hrw
    name: "Human Rights Watch"
    type: rss
    bucket: ngo_rights
    urls:
      - https://www.hrw.org/rss
    filters:
      - keyword: "iran"
    access_grade: A
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true

  # =========================================================================
  # REGIME OUTLETS (72h window)
  # =========================================================================
  - id: irna
    name: "Islamic Republic News Agency"
    type: web
    bucket: regime_outlets
    urls:
      - https://en.irna.ir/service/World
    selectors:
      article: "li.news"
      title: "h3 a"
      date: "time"
      content: ".desc p"
    access_grade: C
    bias_grade: 4
    language: en
    fetcher: src.ingest.fetch_playwright
    enabled: true
    notes: "Arvancloud JS challenge - uses Playwright headless browser."

  - id: tasnim
    name: "Tasnim News Agency"
    type: web
    bucket: regime_outlets
    urls:
      - https://www.tasnimnews.com/en
    access_grade: C
    bias_grade: 4
    language: en
    fetcher: src.ingest.fetch_tasnim
    enabled: false
    notes: "DISABLED - Site hangs during scraping. Custom scraper available if needed."

  - id: mehr
    name: "Mehr News Agency"
    type: web
    bucket: regime_outlets
    urls:
      - https://en.mehrnews.com/
    selectors:
      article: "li.news"
      title: "h3 a"
      date: "time"
      content: ".desc p"
    access_grade: C
    bias_grade: 4
    language: en
    fetcher: src.ingest.fetch_playwright
    enabled: true
    notes: "JS-rendered site - uses Playwright headless browser."

  - id: fars
    name: "Fars News Agency"
    type: web
    bucket: regime_outlets
    urls:
      - https://www.farsnews.ir/en/
    selectors:
      article: "article"
      title: "h2"
      date: "time"
      content: "p"
    access_grade: C
    bias_grade: 5
    language: en
    fetcher: src.ingest.fetch_playwright
    enabled: false
    notes: "DISABLED - Pure JS SPA requiring authentication. Even Playwright cannot render article content. English section appears non-functional."

  - id: presstv
    name: "Press TV"
    type: rss
    bucket: regime_outlets
    urls:
      - https://www.presstv.ir/rss/rss-101.xml
    access_grade: C
    bias_grade: 5
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true
    notes: "IRIB-affiliated English news. Iran section RSS feed."

  # =========================================================================
  # PERSIAN SERVICES (72h window)
  # =========================================================================
  - id: iran_intl
    name: "Iran International"
    type: web
    bucket: persian_services
    urls:
      - https://www.iranintl.com/en
    selectors:
      article: "article.post"
      title: "h2 a"
      date: "time"
      content: ".content"
    access_grade: B
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_web
    enabled: true

  - id: radio_farda
    name: "Radio Farda"
    type: rss
    bucket: persian_services
    urls:
      - https://www.radiofarda.com/api/zmgqoeqotqmo
    access_grade: B
    bias_grade: 2
    language: fa
    fetcher: src.ingest.fetch_rss
    enabled: false
    notes: "DEAD SOURCE - RFE/RL defunded by Trump admin (March 2025). RSS feeds return 0 items. API endpoint removed (404)."

  - id: bbc_persian
    name: "BBC Persian"
    type: rss
    bucket: persian_services
    urls:
      - http://www.bbc.co.uk/persian/index.xml
    access_grade: A
    bias_grade: 2
    language: fa
    fetcher: src.ingest.fetch_rss
    enabled: true

  # =========================================================================
  # INTERNATIONAL WIRES (72h window)
  # =========================================================================
  - id: aljazeera
    name: "Al Jazeera"
    type: rss
    bucket: wires
    urls:
      - https://www.aljazeera.com/xml/rss/all.xml
    filters:
      - keyword: "iran"
    access_grade: A
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true
    notes: "International news with strong Middle East coverage"

  - id: france24
    name: "France 24"
    type: rss
    bucket: wires
    urls:
      - https://www.france24.com/en/rss
    filters:
      - keyword: "iran"
    access_grade: A
    bias_grade: 2
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true
    notes: "French international news service"

  # =========================================================================
  # INTERNET MONITORING (72h window)
  # =========================================================================
  - id: netblocks
    name: "NetBlocks"
    type: rss
    bucket: internet_monitoring
    urls:
      - https://netblocks.org/feed
    filters:
      - keyword: "iran"
    access_grade: A
    bias_grade: 1
    language: en
    fetcher: src.ingest.fetch_rss
    enabled: true
    notes: "Tracks internet shutdowns and connectivity disruptions"

  - id: ooni
    name: "OONI (Open Observatory of Network Interference)"
    type: api
    bucket: internet_monitoring
    urls:
      - https://api.ooni.io/api/v1/measurements
    access_grade: A
    bias_grade: 1
    language: en
    fetcher: src.ingest.fetch_ooni
    enabled: true
    notes: "Crowdsourced censorship measurements from Iran. Detects confirmed and suspected blocks."

  - id: ioda
    name: "IODA Internet Observatory"
    type: api
    bucket: internet_monitoring
    urls:
      - https://api.ioda.inetintel.cc.gatech.edu/v2/signals/raw/country/IR
    access_grade: A
    bias_grade: 1
    language: en
    fetcher: src.ingest.fetch_ioda
    enabled: true
    notes: "Georgia Tech IODA - academic source for internet connectivity monitoring. Uses BGP, Active Probing, and Darknet data."

  # =========================================================================
  # ECONOMIC / FX DATA (72h window)
  # =========================================================================
  - id: bonbast
    name: "Bonbast (Rial Rates)"
    type: api
    bucket: econ_fx
    urls:
      - https://www.bonbast.com/
    access_grade: B
    bias_grade: 1
    language: en
    fetcher: src.ingest.fetch_bonbast
    enabled: true
    notes: "Black market exchange rates via token-based API. Returns structured USD/IRR rates in Rials."

  - id: tgju
    name: "TGJU (Tehran Gold & Jewelry)"
    type: web
    bucket: econ_fx
    urls:
      - https://www.tgju.org/
    selectors:
      article: ".market-table"
      title: "h1"
      date: ".date"
      content: ".price"
    access_grade: B
    bias_grade: 1
    language: fa
    fetcher: src.ingest.fetch_web
    enabled: true
    notes: "Gold/currency prices; may need custom parser"

  # =========================================================================
  # WIRE SERVICES (manual - require license)
  # =========================================================================
  - id: reuters
    name: "Reuters"
    type: manual
    bucket: wires
    notes: "Requires licensed access or manual copy-paste"
    access_grade: A
    bias_grade: 1
    language: en
    enabled: false

  - id: ap
    name: "Associated Press"
    type: manual
    bucket: wires
    notes: "Requires licensed access or manual copy-paste"
    access_grade: A
    bias_grade: 1
    language: en
    enabled: false
